#!/usr/bin/env python3

import argparse
import sys
from rich.console import Console
from rich.markdown import Markdown


def render_markdown(content):
    console = Console()
    with console.pager():
        markdown = Markdown(content)
        console.print(markdown)


def main():
    parser = argparse.ArgumentParser(
        description="Render Markdown files in the shell using the rich library with paging support.")
    parser.add_argument(
        "file", nargs='?', help="Path to the Markdown file to render. If not provided, reads from stdin.")
    parser.add_argument("-v", "--version", action="version",
                        version="Markdown Renderer 1.0")

    args = parser.parse_args()

    content = ""
    if args.file:
        try:
            with open(args.file, 'r') as file:
                content = file.read()
        except FileNotFoundError:
            sys.stderr.write(f"Error: File '{args.file}' not found.\n")
            sys.exit(1)
        except Exception as e:
            sys.stderr.write(f"Error: An unexpected error occurred: {e}\n")
            sys.exit(1)
    else:
        if sys.stdin.isatty():
            parser.print_help()
            sys.exit(1)
        else:
            content = sys.stdin.read()

    render_markdown(content)


if __name__ == "__main__":
    main()
